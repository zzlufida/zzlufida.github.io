window.repositoryObject = {"columns_custom_fields":[],"relations_custom_fields":[],"triggers_custom_fields":[],"object_id":"v11770","name":"NE_vwReturnToLoan","subtype":"VIEW","is_user_defined":false,"description":null,"script":"CREATE VIEW NE_vwReturnToLoan      \r\nAS      \r\n    --拉冲销到还款的单据          \r\nSELECT  NEWID() AS PkID ,      \r\n        Loan.Code ,      \r\n        OperationType.Name ,      \r\n        LoanSub.ID ,      \r\n        LoanSub.RowNO AS RowNO ,      \r\n        LoanSub.DeptID ,      \r\n        LoanSub.BorrowerID ,      \r\n        LoanSub.ItemClassID ,      \r\n        LoanSub.ItemID ,      \r\n        Person.cPersonName AS cPsn_Name ,      \r\n        Department.cDepName AS cDepName ,      \r\n        fitem.citem_name AS citem_name ,      \r\n        vwNEfitemss.citemname AS citemname ,      \r\n        Loan.Currency ,      \r\n        ForeignCurrency.cexch_name , \r\n        Loan.LoanDate , \r\n        Loan.Used ,      \r\n        LoanSub.PayType ,      \r\n        ROUND(LoanSub.DebtMoney, 2) AS DebtMoney ,      \r\n        LoanSub.LoanVouchID ,      \r\n        Loan.PayState ,      \r\n        Loan.VouchState ,      \r\n        ISNULL(Loan.ExchangeRate, 0)      \r\n        * ( CASE WHEN ISNULL(LoanSub.FactMoney, 0) = 0      \r\n                 THEN ISNULL(LoanSub.PlanMoney, 0)      \r\n                 ELSE ISNULL(LoanSub.FactMoney, 0)      \r\n            END ) AS LocalMoney_Sub ,      \r\n        CASE WHEN ISNULL(CONVERT(NVARCHAR(250), NE_ExpenseLoanInfo.ID), '') = ''      \r\n             THEN 0      \r\n             ELSE NE_ExpenseLoanInfo.ReturnMoney      \r\n        END AS UseAbleMoney ,      \r\n        LoanSub.ts ,      \r\n       CONVERT(UNIQUEIDENTIFIER, CASE WHEN ISNULL(CONVERT(NVARCHAR(250), NE_ExpenseLoanInfo.ID), '') = ''      \r\n             THEN null      \r\n             ELSE CONVERT(NVARCHAR(250), NE_ExpenseLoanInfo.ID)      \r\n        END) AS ExpenseLoanInfoID ,      \r\n         CONVERT(UNIQUEIDENTIFIER,CASE WHEN ISNULL(CONVERT(NVARCHAR(250), NE_ExpenseLoanInfo.ReturnVouchID),      \r\n                         '') = '' THEN null     \r\n             ELSE CONVERT(NVARCHAR(250), NE_ExpenseLoanInfo.ReturnVouchID)      \r\n        END) AS ReturnVouchID ,      \r\n        CASE WHEN ISNULL(CONVERT(NVARCHAR(250), NE_ExpenseLoanInfo.ID), '') = ''      \r\n             THEN 0      \r\n             ELSE NE_ExpenseLoanInfo.Ts      \r\n        END AS ExpenseLoanInfoTs ,      \r\n        LoanSub.FactMoney AS FactMoney ,      \r\n        LoanSub.PlanMoney AS PlanMoney ,      \r\n        '0' AS ReturnType,      \r\n        LoanSub.CusCode AS CusCode ,      \r\n        LoanSub.VenCode AS VenCode,  \r\n        Loan.OperationTypeCode  \r\nFROM    NE_LoanVouch_Sub AS LoanSub WITH ( NOLOCK )      \r\n        INNER JOIN NE_LoanVouch AS Loan WITH ( NOLOCK ) ON LoanSub.LoanVouchID = Loan.ID      \r\n        LEFT JOIN NE_ExpenseLoanInfo WITH ( NOLOCK ) ON NE_ExpenseLoanInfo.LoanVouchSubID = LoanSub.ID      \r\n        LEFT JOIN ForeignCurrency WITH ( NOLOCK ) ON Loan.Currency = ForeignCurrency.cexch_name      \r\n        LEFT JOIN Department WITH ( NOLOCK ) ON LoanSub.DeptID = Department.cDepCode      \r\n        LEFT JOIN Person WITH ( NOLOCK ) ON LoanSub.BorrowerID = Person.cPersonCode      \r\n        LEFT JOIN vwNEfitemss WITH ( NOLOCK ) ON LoanSub.ItemID = vwNEfitemss.citemcode      \r\n                                 AND LoanSub.ItemClassID = vwNEfitemss.citem_class--项目          \r\n        LEFT JOIN fitem WITH ( NOLOCK ) ON LoanSub.ItemClassID = fitem.citem_class--项目大类  \r\n        LEFT JOIN NE_OperationType as OperationType WITH ( NOLOCK ) ON Loan.OperationTypeCode = OperationType.Code--业务类型  \r\nWHERE   ( CASE WHEN ISNULL(CONVERT(NVARCHAR(250), NE_ExpenseLoanInfo.ID), '') = ''      \r\n               THEN 0      \r\n               ELSE NE_ExpenseLoanInfo.ReturnMoney      \r\n          END ) > 0      \r\nUNION ALL         \r\n--拉借款到还款的单据          \r\nSELECT  NEWID() AS PkID ,      \r\n        a.*      \r\nFROM    ( SELECT DISTINCT      \r\n                    Loan.Code ,      \r\n                    OperationType.Name ,      \r\n                    LoanSub.ID ,      \r\n                    LoanSub.RowNO AS RowNO ,      \r\n                    LoanSub.DeptID ,      \r\n                    LoanSub.BorrowerID ,      \r\n                    LoanSub.ItemClassID ,      \r\n                    LoanSub.ItemID ,      \r\n                    Person.cPersonName AS cPsn_Name ,      \r\n                    Department.cDepName AS cDepName ,      \r\n                    fitem.citem_name AS citem_name ,      \r\n                    vwNEfitemss.citemname AS citemname ,      \r\n                    Loan.Currency ,      \r\n                    ForeignCurrency.cexch_name ,   \r\n                    Loan.LoanDate , \r\n\t\t\t\t\tLoan.Used ,    \r\n                    LoanSub.PayType ,      \r\n                    ROUND(LoanSub.DebtMoney, 2) AS DebtMoney ,      \r\n                    LoanSub.LoanVouchID ,      \r\n                   Loan.PayState ,      \r\n                    Loan.VouchState ,      \r\n                    ISNULL(Loan.ExchangeRate, 0)      \r\n                    * ( CASE WHEN ISNULL(LoanSub.FactMoney, 0) = 0      \r\n                             THEN ISNULL(LoanSub.PlanMoney, 0)      \r\n                             ELSE ISNULL(LoanSub.FactMoney, 0)      \r\n                        END ) AS LocalMoney_Sub ,      \r\n                    0.00 AS UseAbleMoney ,      \r\n                    LoanSub.ts ,      \r\n                    cast(NULL AS UNIQUEIDENTIFIER)  AS ExpenseLoanInfoID ,      \r\n                    cast(NULL AS UNIQUEIDENTIFIER)  AS ReturnVouchID ,      \r\n                    0 AS ExpenseLoanInfoTs ,      \r\n                    LoanSub.FactMoney AS FactMoney ,      \r\n                    LoanSub.PlanMoney AS PlanMoney ,      \r\n                    '1' AS ReturnType,      \r\n                    LoanSub.CusCode AS CusCode ,      \r\n                    LoanSub.VenCode AS VenCode,  \r\n                    Loan.OperationTypeCode  \r\n          FROM      NE_LoanVouch_Sub AS LoanSub WITH ( NOLOCK )      \r\n                    INNER JOIN NE_LoanVouch AS Loan WITH ( NOLOCK ) ON LoanSub.LoanVouchID = Loan.ID      \r\n                    LEFT JOIN NE_ExpenseLoanInfo WITH ( NOLOCK ) ON NE_ExpenseLoanInfo.LoanVouchSubID = LoanSub.ID      \r\n                    LEFT JOIN ForeignCurrency WITH ( NOLOCK ) ON Loan.Currency = ForeignCurrency.cexch_name      \r\n                    LEFT JOIN Department WITH ( NOLOCK ) ON LoanSub.DeptID = Department.cDepCode      \r\n                    LEFT JOIN Person WITH ( NOLOCK ) ON LoanSub.BorrowerID = Person.cPersonCode      \r\n                    LEFT JOIN vwNEfitemss WITH ( NOLOCK ) ON LoanSub.ItemID = vwNEfitemss.citemcode      \r\n                                             AND LoanSub.ItemClassID = vwNEfitemss.citem_class--项目          \r\n                    LEFT JOIN fitem WITH ( NOLOCK ) ON LoanSub.ItemClassID = fitem.citem_class--项目大类  \r\n                    LEFT JOIN NE_OperationType as OperationType WITH ( NOLOCK ) ON Loan.OperationTypeCode = OperationType.Code--业务类型  \r\n                \r\n        ) a","summary":[{"field":"Documentation","value":{"_type":"link","name":"U8V16.5数据字典","id":"d6"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"NE_vwReturnToLoan"},{"field":"Type","value":"View"}],"columns":[{"id":"column-251317","object_id":"column-251317","name":"PkID","name_without_path":"PkID","description":null,"is_pk":false,"is_identity":false,"data_type":"uniqueidentifier","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251318","object_id":"column-251318","name":"Code","name_without_path":"Code","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251319","object_id":"column-251319","name":"Name","name_without_path":"Name","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"255","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251320","object_id":"column-251320","name":"ID","name_without_path":"ID","description":null,"is_pk":false,"is_identity":false,"data_type":"uniqueidentifier","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251321","object_id":"column-251321","name":"RowNO","name_without_path":"RowNO","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251322","object_id":"column-251322","name":"DeptID","name_without_path":"DeptID","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251323","object_id":"column-251323","name":"BorrowerID","name_without_path":"BorrowerID","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251324","object_id":"column-251324","name":"ItemClassID","name_without_path":"ItemClassID","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"50","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251325","object_id":"column-251325","name":"ItemID","name_without_path":"ItemID","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"60","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251326","object_id":"column-251326","name":"cPsn_Name","name_without_path":"cPsn_Name","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"40","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251327","object_id":"column-251327","name":"cDepName","name_without_path":"cDepName","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"255","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251328","object_id":"column-251328","name":"citem_name","name_without_path":"citem_name","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"50","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251329","object_id":"column-251329","name":"citemname","name_without_path":"citemname","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"255","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251330","object_id":"column-251330","name":"Currency","name_without_path":"Currency","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251331","object_id":"column-251331","name":"cexch_name","name_without_path":"cexch_name","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"8","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251332","object_id":"column-251332","name":"LoanDate","name_without_path":"LoanDate","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251333","object_id":"column-251333","name":"Used","name_without_path":"Used","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"1024","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251334","object_id":"column-251334","name":"PayType","name_without_path":"PayType","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251335","object_id":"column-251335","name":"DebtMoney","name_without_path":"DebtMoney","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"12, 2","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251336","object_id":"column-251336","name":"LoanVouchID","name_without_path":"LoanVouchID","description":null,"is_pk":false,"is_identity":false,"data_type":"uniqueidentifier","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251337","object_id":"column-251337","name":"PayState","name_without_path":"PayState","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251338","object_id":"column-251338","name":"VouchState","name_without_path":"VouchState","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251339","object_id":"column-251339","name":"LocalMoney_Sub","name_without_path":"LocalMoney_Sub","description":null,"is_pk":false,"is_identity":false,"data_type":"float","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251340","object_id":"column-251340","name":"UseAbleMoney","name_without_path":"UseAbleMoney","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"12, 2","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251341","object_id":"column-251341","name":"ts","name_without_path":"ts","description":null,"is_pk":false,"is_identity":false,"data_type":"timestamp","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251342","object_id":"column-251342","name":"ExpenseLoanInfoID","name_without_path":"ExpenseLoanInfoID","description":null,"is_pk":false,"is_identity":false,"data_type":"uniqueidentifier","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251343","object_id":"column-251343","name":"ReturnVouchID","name_without_path":"ReturnVouchID","description":null,"is_pk":false,"is_identity":false,"data_type":"uniqueidentifier","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251344","object_id":"column-251344","name":"ExpenseLoanInfoTs","name_without_path":"ExpenseLoanInfoTs","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251345","object_id":"column-251345","name":"FactMoney","name_without_path":"FactMoney","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"12, 2","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251346","object_id":"column-251346","name":"PlanMoney","name_without_path":"PlanMoney","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"12, 2","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251347","object_id":"column-251347","name":"ReturnType","name_without_path":"ReturnType","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"1","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251348","object_id":"column-251348","name":"CusCode","name_without_path":"CusCode","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251349","object_id":"column-251349","name":"VenCode","name_without_path":"VenCode","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-251350","object_id":"column-251350","name":"OperationTypeCode","name_without_path":"OperationTypeCode","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]}],"relations":[],"triggers":[],"unique_keys":[],"dependencies":null,"imported_at":"2024-07-15 13:47"};