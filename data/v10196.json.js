window.repositoryObject = {"columns_custom_fields":[],"relations_custom_fields":[],"triggers_custom_fields":[],"object_id":"v10196","name":"CM_QContractAllForCreateVoucher","subtype":"VIEW","is_user_defined":false,"description":null,"script":"----参照合同生单需要的合同视图\r\n\r\nCREATE       View [dbo].[CM_QContractAllForCreateVoucher]\r\nas\r\nselect  C.GUID,C.strContractID,C.strContractName,C.strParentID,G.cGroupName,TC.cClassName,strContractType,C.strWay,\r\n\tT.cTypeName,C.strContractGrp,C.strContractKind,C.intPre,dbo.UDF_GetResourceMessageByID('U8.CW.CM.Effect') As strState,\r\n\tC.strSetupDate,C.strBisectionUnit,\r\n\t(case Upper(C.strSource) when 'C' then C.strBisectionUnit else N'' end) as strBisectionUnitC,\r\n\t(case Upper(C.strSource) when 'V' then C.strBisectionUnit else N'' end) as strBisectionUnitV,\r\n\tC.strCurrency,\r\n\tC.strInureDate,C.strEndCaseDate,C.strDeptID,C.strPersonID,\r\n\tC.strContractOrderDate,C.strContractStartDate,C.strContractEndDate,C.cGatheringPlan,\r\n\t--权限内容\r\n\tC.strContractKind as ContractKind,C.strSetupPerson as SetupPerson,C.strInurePerson as InurePerson,\r\n\tC.strBisectionUnit as BisectionUnit,C.strDeptID as DeptID,Ven.iID as VenIID,Cus.iID as CusIID,\r\n--\tC.dblMassassureScale as decZbjRatio,C.dblMassassure,\r\n\t(case when isnull(C.cZbjComputeMode,N'total')=N'total' then IsNull(C.dblMassassureScale,0)\r\n              when isnull(C.cZbjComputeMode,N'total')=N'step' and IV.dblTotalCurrency<>0 then IV.dblTotalZbjMoney*100/IV.dblTotalCurrency\r\n              else 0 end) as dblMassassureScale,\r\n        (case when isnull(C.cZbjComputeMode,N'total')=N'total' then IsNull(IV.dblTotalCurrency,0)*C.dblMassassureScale/100\r\n              else IV.dblTotalZbjMoney end) as dblMassassure, \r\n\r\nC.dtZbjStartDate, C.dtZbjEndDate,C.cZbjComputeMode,\r\n        (case isnull(CAval.strContractID,N'') when N'' then N'1' else N'0' end) as bFinished,\r\n\tC.bUseStage\r\nfrom CM_Contract_B C\r\nJOIN dbo.CM_Type T ON C.strContractType = T.cTypeCode \r\nJOIN dbo.CM_TypeClass TC ON T.cClassCode = TC.cClassCode \r\nLEFT JOIN dbo.CM_Group G ON C.strContractGrp = G.cGroupID\r\nleft join Vendor Ven on Ven.cVenCode=C.strBisectionUnit\r\nleft join Customer Cus on Cus.cCusCode=C.strBisectionUnit\r\nleft JOIN (select I.GUID,sum(isnull(I.dblSum,0)) AS dblTotalCurrency\t\t--含税金额原币\r\n                        ,sum(isnull(I.decZbjMoney,0)) AS dblTotalZbjMoney --质保金金额\r\n\tfrom CM_Contract_Item_B I where I.intEnd=1 and intFlag <> 1 group by I.GUID) IV ON IV.GUID=C.GUID\r\nleft join \r\n(\r\n\tselect distinct IB.strContractID\r\n\tfrom CM_Contract_Item_B IB\r\n\tleft join\r\n\t(\r\n\t\tselect cContractID,cCode,sum(decCount) as decExecCount,sum(decRateMoney) as decExecRateMoney \r\n\t\tfrom (select cContractID,cContractObjectID as cCode,\r\n\t\t      sum(decCount) as decCount,sum(decRateMoney) as decRateMoney \r\n\t\t      from CM_ExecuteBills EBS inner join CM_ExecuteBill EB on EBS.cExecID=EB.cExecID \r\n\t\t      group by cContractID,cContractObjectID \r\n\t\t      Union All \r\n\t\t      select cContractID,cCode,sum(decCount) as decCount,sum(decRateMoney) as decRateMoney \r\n\t\t      from CM_Balances BS inner join CM_Balance B on BS.cBalanceID=B.cBalanceID \r\n\t\t      where isnull(cExecID,N'')=N'' \r\n\t\t      group by cContractID,cCode \r\n\t\t      )CB \r\n\t\tgroup by cContractID,cCode\r\n\t)IE on IB.strContractID=IE.cContractID and IB.strCode=IE.cCode\r\n\twhere (isnull(IB.dblQuantity,0)-isnull(IE.decExecCount,0)>0) or \r\n\t      (isnull(IB.dblSum,0)-isnull(IE.decExecRateMoney,0)>0)         \r\n)CAval on C.strContractID=CAval.strContractID","summary":[{"field":"Documentation","value":{"_type":"link","name":"U8V16.5数据字典","id":"d6"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"CM_QContractAllForCreateVoucher"},{"field":"Type","value":"View"}],"columns":[{"id":"column-176609","object_id":"column-176609","name":"GUID","name_without_path":"GUID","description":null,"is_pk":false,"is_identity":false,"data_type":"uniqueidentifier","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176610","object_id":"column-176610","name":"strContractID","name_without_path":"strContractID","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"64","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176611","object_id":"column-176611","name":"strContractName","name_without_path":"strContractName","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"400","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176612","object_id":"column-176612","name":"strParentID","name_without_path":"strParentID","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"64","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176613","object_id":"column-176613","name":"cGroupName","name_without_path":"cGroupName","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"40","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176614","object_id":"column-176614","name":"cClassName","name_without_path":"cClassName","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"40","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176615","object_id":"column-176615","name":"strContractType","name_without_path":"strContractType","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"12","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176616","object_id":"column-176616","name":"strWay","name_without_path":"strWay","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"50","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176617","object_id":"column-176617","name":"cTypeName","name_without_path":"cTypeName","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"40","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176618","object_id":"column-176618","name":"strContractGrp","name_without_path":"strContractGrp","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"12","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176619","object_id":"column-176619","name":"strContractKind","name_without_path":"strContractKind","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"32","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176620","object_id":"column-176620","name":"intPre","name_without_path":"intPre","description":null,"is_pk":false,"is_identity":false,"data_type":"tinyint","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176621","object_id":"column-176621","name":"strState","name_without_path":"strState","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"2048","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176622","object_id":"column-176622","name":"strSetupDate","name_without_path":"strSetupDate","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176623","object_id":"column-176623","name":"strBisectionUnit","name_without_path":"strBisectionUnit","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176624","object_id":"column-176624","name":"strBisectionUnitC","name_without_path":"strBisectionUnitC","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176625","object_id":"column-176625","name":"strBisectionUnitV","name_without_path":"strBisectionUnitV","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176626","object_id":"column-176626","name":"strCurrency","name_without_path":"strCurrency","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"16","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176627","object_id":"column-176627","name":"strInureDate","name_without_path":"strInureDate","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176628","object_id":"column-176628","name":"strEndCaseDate","name_without_path":"strEndCaseDate","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176629","object_id":"column-176629","name":"strDeptID","name_without_path":"strDeptID","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"30","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176630","object_id":"column-176630","name":"strPersonID","name_without_path":"strPersonID","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"30","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176631","object_id":"column-176631","name":"strContractOrderDate","name_without_path":"strContractOrderDate","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176632","object_id":"column-176632","name":"strContractStartDate","name_without_path":"strContractStartDate","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176633","object_id":"column-176633","name":"strContractEndDate","name_without_path":"strContractEndDate","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176634","object_id":"column-176634","name":"cGatheringPlan","name_without_path":"cGatheringPlan","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"15","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176635","object_id":"column-176635","name":"ContractKind","name_without_path":"ContractKind","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"32","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176636","object_id":"column-176636","name":"SetupPerson","name_without_path":"SetupPerson","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176637","object_id":"column-176637","name":"InurePerson","name_without_path":"InurePerson","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176638","object_id":"column-176638","name":"BisectionUnit","name_without_path":"BisectionUnit","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176639","object_id":"column-176639","name":"DeptID","name_without_path":"DeptID","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"30","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176640","object_id":"column-176640","name":"VenIID","name_without_path":"VenIID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176641","object_id":"column-176641","name":"CusIID","name_without_path":"CusIID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176642","object_id":"column-176642","name":"dblMassassureScale","name_without_path":"dblMassassureScale","description":null,"is_pk":false,"is_identity":false,"data_type":"float","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176643","object_id":"column-176643","name":"dblMassassure","name_without_path":"dblMassassure","description":null,"is_pk":false,"is_identity":false,"data_type":"float","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176644","object_id":"column-176644","name":"dtZbjStartDate","name_without_path":"dtZbjStartDate","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176645","object_id":"column-176645","name":"dtZbjEndDate","name_without_path":"dtZbjEndDate","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176646","object_id":"column-176646","name":"cZbjComputeMode","name_without_path":"cZbjComputeMode","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"10","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176647","object_id":"column-176647","name":"bFinished","name_without_path":"bFinished","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"1","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-176648","object_id":"column-176648","name":"bUseStage","name_without_path":"bUseStage","description":null,"is_pk":false,"is_identity":false,"data_type":"bit","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]}],"relations":[],"triggers":[],"unique_keys":[],"dependencies":null,"imported_at":"2024-07-15 13:47"};