window.repositoryObject = {"columns_custom_fields":[],"relations_custom_fields":[],"triggers_custom_fields":[],"object_id":"v13270","name":"V_HR_WA_Messages","subtype":"VIEW","is_user_defined":false,"description":null,"script":"/*==============================================================*/\r\n/* View: V_HR_WA_Messages                                       */\r\n/*==============================================================*/\r\nCREATE  view V_HR_WA_Messages as \r\n\r\nselect * from (\r\n\r\nselect T1.pk_hr_hi_busData as MessageID,\r\n\tT1.dChangeDate as MessageTime,\r\n\t'MessageContent'=\r\n\tcase when NewPerson='' then cpsn_name +':'+ PersonType +Dep+JobCode+DutyCode+NewPerson\r\n\t\telse PersonType +Dep+JobCode+DutyCode+NewPerson \r\n\tend\r\nfrom \r\n(\r\nselect pk_hr_hi_busData,\r\n'PersonType'=\r\n\tcase \r\n\t\twhen cPrePersonType is null  and cChangedPersonType  is null then ''\r\n\t\twhen cPrePersonType is null and cChangedPersonType  is not null then '人员类别从无变为' + newType+'类别;'\r\n\t\twhen cPrePersonType is not null and cChangedPersonType  is  null then '人员类别从' + oldtype + '类别变为无'+';'\r\n\t\twhen cPrePersonType is not null and cChangedPersonType  is not null\r\n\t\t\tand cPrePersonType<>cChangedPersonType then '人员类别从' + oldtype + '类别变为' + newType +'类别;'\r\n\t\telse\r\n\t\t\t''\r\n\t\tend,\r\n\r\n'Dep'=\r\n\tcase \r\n\t\twhen cPreDepCode is null  and cChangedDepCode  is null then ''\r\n\t\twhen cPreDepCode is null and cChangedDepCode  is not null then '部门从无调到' + newDep+';'\r\n\t\twhen cPreDepCode is not null and cChangedDepCode  is  null then '部门从' + OldDep + '调到无'+';'\r\n\t\twhen cPreDepCode is not null and cChangedDepCode  is not null\r\n\t\t\tand cPreDepCode<>cChangedDepCode then '部门从' + OldDep + '调到' + newDep+';'\r\n\t\telse\r\n\t\t\t''\r\n\t\tend,\r\n'JobCode'=\r\n\tcase \r\n\t\twhen cPreJobCode is null  and cChangedJobCode  is null then ''\r\n\t\twhen cPreJobCode is null and cChangedJobCode  is not null then '岗位从无化为' + NewJob+';'\r\n\t\twhen cPreJobCode is not null and cChangedJobCode  is  null then '岗位从' + OldJob + '变为无'+';'\r\n\t\twhen cPreJobCode is not null and cChangedJobCode  is not null\r\n\t\t\tand cPreJobCode<>cChangedJobCode then '岗位从' + OldJob + '变为' + NewJob+';'\r\n\t\telse\r\n\t\t\t''\r\n\t\tend,\r\n'DutyCode'=\r\n\tcase \r\n\t\twhen cPreDutyCode is null  and cChangedDutyCode  is null then ''\r\n\t\twhen cPreDutyCode is null and cChangedDutyCode  is not null then '职位从无变为' + NewDuty+';'\r\n\t\twhen cPreDutyCode is not null and cChangedDutyCode  is  null then '职位从' + OldDuty + '变化为无'+';'\r\n\t\twhen cPreDutyCode is not null and cChangedDutyCode  is not null\r\n\t\t\tand cPreDutyCode<>cChangedDutyCode then '职位从' + OldDuty + '变为' + NewDuty+';'\r\n\t\telse\r\n\t\t\t''\r\n\t\tend,\r\n'NewPerson'=\r\n\tcase \r\n\t\twhen  cBusinessid='Hi_NewP' then cChangeCause  else '' end,\r\n 'cpsn_name'=\r\n\tcase when cpsn_name=null or cpsn_name ='' then cpsn_num else cpsn_name end,\r\ndChangeDate from \r\n(\r\nselect 'oldType'=case when cPrePersonType=P1.ccodeID then P1.vdescription else\t''end,\r\n\t'NewType'=case when cChangedPersonType=P2.ccodeID then P2.vdescription else '' end,\r\n\t'OldDep'=\tcase when cPreDepCode=P3.cDepCode then P3.cDepName else '' end,\r\n\t'NewDep'=\tcase when cChangedDepCode=P4.cDepCode then P4.cDepName else '' end,\r\n\t'OldJob'=case when cPreJobCode=P5.cJobcode then P5.vjobname else '' end,\r\n\t'NewJob'=case when cChangedJobCode=P6.cJobcode then P6.vjobname else '' end,\r\n\t'OldDuty'=case when cPreDutyCode=P7.cDutycode then P7.vdutyname else '' end,\r\n\t'NewDuty'=case when cChangedDutyCode=P8.cDutycode then P8.vdutyname else '' end,\r\n\t\tv_hr_hi_MsgOutData.* from v_hr_hi_MsgOutData \r\n\t\tleft OUTER JOIN HR_CT000 as P1\ton cPrePersonType=P1.ccodeID\r\n\t\tleft OUTER JOIN HR_CT000 as P2\ton cChangedPersonType=P2.ccodeID\r\n\t\tleft OUTER JOIN department as P3\ton cPreDepCode=P3.cDepCode\r\n\t\tleft OUTER JOIN department as P4\ton cChangedDepCode=P4.cDepCode\r\n\t\tleft OUTER JOIN hr_om_job as P5\ton cPreJobCode=P5.cJobcode\r\n\t\tleft OUTER JOIN hr_om_job as P6\ton cChangedJobCode=P6.cJobcode\r\n\t\tleft OUTER JOIN hr_om_duty as P7\ton cPreDutyCode=P7.cDutycode\r\n\t\tleft OUTER JOIN hr_om_duty as P8\ton cChangedDutyCode=P8.cDutycode\r\n) as DTList\r\nwhere  bAudit=1 and cast(DTList.pk_hr_hi_busData as char(200)) not in \r\n(select MessageID from hr_wa_markedmessage) \r\n) as T1 \r\n) as MES where messagecontent<>''","summary":[{"field":"Documentation","value":{"_type":"link","name":"U8V16.5数据字典","id":"d6"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"V_HR_WA_Messages"},{"field":"Type","value":"View"}],"columns":[{"id":"column-359766","object_id":"column-359766","name":"MessageID","name_without_path":"MessageID","description":null,"is_pk":false,"is_identity":false,"data_type":"uniqueidentifier","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-359767","object_id":"column-359767","name":"MessageTime","name_without_path":"MessageTime","description":null,"is_pk":false,"is_identity":false,"data_type":"nchar","data_length":"10","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-359768","object_id":"column-359768","name":"MessageContent","name_without_path":"MessageContent","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"705","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]}],"relations":[],"triggers":[],"unique_keys":[],"dependencies":null,"imported_at":"2024-07-15 13:47"};