window.repositoryObject = {"columns_custom_fields":[],"relations_custom_fields":[],"triggers_custom_fields":[],"object_id":"v10355","name":"CM_V_ApClosePurs","subtype":"VIEW","is_user_defined":false,"description":null,"script":"CREATE VIEW CM_V_ApClosePurs as \r\nselect max(Ap_CloseBill.iID) as I_id,\r\nAp_VouchType.cTypeName as cVoucherType,\r\nAp_Detail.cVouchID,\t\t--收付款单号\r\nAp_Detail.cCoVouchID,\t\t--核销的原始单据号，结算单号，或者采购发票号\r\nzpurbillHead.cPbvBillType As cCoVoucherType,\r\nmax(case when Ap_Detail.cCoVouchType like N'60%' then Ap_Detail.cContractID \r\n\t\telse zpurbilltail.ContractCode end) as strContractID,\t\t-- 合同号\r\n(case when Ap_Detail.cCoVouchType like N'60%' Then CI.RowGUID \r\n\t\telse zpurbilltail.ContractRowGuid end) as ContractRowGuid,\t--合同标的RowGUID\r\n(case when Ap_Detail.cCoVouchType like N'60%' Then CI.strCode \r\n\t\telse zpurbilltail.ContractRowNo end) as strCode,\t--合同标的strCode\r\nAp_Detail.balancesguid,\t\t\t\t--结算单子表GUID\r\nAp_detail.ibvid,\t\t\t\t--采购发票子表ID\r\n--Max(Ap_Detail.cOrderNo) as cOrderNo,\t\t--采购订单号\r\nmax(zpurbilltail.iPOsID) as iPOsID,\t\t--采购订单子表ID\r\nsum(Ap_Detail.iDAmount_f) as iAmount_f,\t\t--原币金额\r\nsum(Ap_Detail.iDAmount) as iAmount,\t\t--本币\r\nmax(Ap_Detail.cCode) as cCode,\r\nMax(Ap_Detail.cItemCode) as cItemCode,\r\nMax(Ap_Detail.dVouchDate) as dVouchDate\r\nfrom Ap_Detail\r\nLEFT JOIN Ap_VouchType ON Ap_Detail.cVouchType = Ap_VouchType.cTypeCode \r\nLeft Join Ap_CloseBill On Ap_Detail.cDwCode=Ap_CloseBill.cDwCode and Ap_Detail.cVouchType=Ap_CloseBill.cVouchType And Ap_Detail.cVouchID=Ap_CloseBill.cVouchID And Ap_Detail.cFlag=Ap_CloseBill.cFlag\r\nLeft Join zpurbilltail on Ap_Detail.ibvid=zpurbilltail.id\r\nLeft Join zpurbillHead on zpurbillHead.pbvid=zpurbilltail.pbvid\r\nLeft Join (select V.RowGUID,V.strCode,S.balancesguid from CM_QContractItemView V\r\n\tINNER JOIN CM_Balance B On V.strContractID=B.cContractID\r\n\tINNER JOIN CM_Balances S On B.cBalanceID=S.cBalanceID And V.strCode=S.cCode)\r\n\tCI On Ap_Detail.balancesguid =CI.balancesguid\r\nwhere (cprocstyle=N'9P' or cprocstyle=N'XJ') and (iFlag<3 or iFlag=5) and Ap_Detail.cFlag=N'AP'\r\nand Ap_Detail.cvouchtype like N'4%' and Ap_Detail.ccovouchtype IN ('01','02','03','04','05','06','60','60z')\r\ngroup by Ap_Detail.cdwcode,Ap_Detail.ccovouchtype,Ap_Detail.ccovouchid,Ap_detail.ibvid,\r\nAp_VouchType.cTypeName,Ap_Detail.cvouchid,Ap_Detail.balancesguid,ContractRowGuid,CI.RowGUID,CI.strCode,ContractRowNo,zpurbillHead.cPbvBillType\r\n\r\nUnion\r\n\r\nselect max(Ap_CloseBill.iID) as I_id,\r\nAp_VouchType.cTypeName as cVoucherType,\r\nAp_Detail.cVouchID,\r\ndbo.UDF_GetResourceMessageByID('U8.CW.CM.PrePay') As cCoVouchID,\t\t\t\t--结算单号，销售发票号\r\nNull As cCoVoucherType,\r\nAp_Detail.cContractID as strContractID,\t\t-- 合同号\r\nNull as ContractRowGuid,\t--合同标的RowGUID\r\nNull As strCode,\r\nNull as balancesguid,\r\nNull As ibvid,\t\t\t\t--销售发票子表ID\r\nNull As iSOsID,\t\t--销售订单子表ID\r\n--U82015102200171\r\n--sum(Ap_Detail.iDAmount_f) As  iAmount_f,\r\n--sum(Ap_Detail.iDAmount) as iAmount,\t\t--本币\r\nsum(Ap_Detail.iDAmount_f-Ap_Detail.iCAmount_f) As  iAmount_f,\r\nsum(Ap_Detail.iDAmount-Ap_Detail.iCAmount) as iAmount,\t\t--本币\r\n\r\nNull As cCode,\r\nNull As cItemCode,\r\nMax(Ap_Detail.dVouchDate) as dVouchDate\r\nfrom Ap_Detail\r\nLEFT JOIN Ap_VouchType ON Ap_Detail.cVouchType = Ap_VouchType.cTypeCode \r\nLeft Join Ap_CloseBill On Ap_Detail.cDwCode=Ap_CloseBill.cDwCode and Ap_Detail.cVouchType=Ap_CloseBill.cVouchType And Ap_Detail.cVouchID=Ap_CloseBill.cVouchID And Ap_Detail.cFlag=Ap_CloseBill.cFlag\r\n--U82015102200171\r\n--where Ap_Detail.cFlag=N'AP' and Ap_Detail.cvouchtype like N'4%'  and iflag<3 \r\nwhere Ap_Detail.cFlag=N'AP' and Ap_Detail.cCoVouchType like N'4%'  and iflag<3 --and ISNULL(cexecID,'') <> '' and AP_Detail.bPrePay=1 v12.0支持问题 U82015040900516\r\ngroup by Ap_Detail.cdwcode,Ap_VouchType.cTypeName,Ap_Detail.cvouchid,Ap_Detail.cContractID","summary":[{"field":"Documentation","value":{"_type":"link","name":"U8V16.5数据字典","id":"d6"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"CM_V_ApClosePurs"},{"field":"Type","value":"View"}],"columns":[{"id":"column-184357","object_id":"column-184357","name":"I_id","name_without_path":"I_id","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-184358","object_id":"column-184358","name":"cVoucherType","name_without_path":"cVoucherType","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"60","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-184359","object_id":"column-184359","name":"cVouchID","name_without_path":"cVouchID","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"30","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-184360","object_id":"column-184360","name":"cCoVouchID","name_without_path":"cCoVouchID","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"2048","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-184361","object_id":"column-184361","name":"cCoVoucherType","name_without_path":"cCoVoucherType","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"4","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-184362","object_id":"column-184362","name":"strContractID","name_without_path":"strContractID","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"128","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-184363","object_id":"column-184363","name":"ContractRowGuid","name_without_path":"ContractRowGuid","description":null,"is_pk":false,"is_identity":false,"data_type":"uniqueidentifier","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-184364","object_id":"column-184364","name":"strCode","name_without_path":"strCode","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"150","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-184365","object_id":"column-184365","name":"balancesguid","name_without_path":"balancesguid","description":null,"is_pk":false,"is_identity":false,"data_type":"uniqueidentifier","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-184366","object_id":"column-184366","name":"ibvid","name_without_path":"ibvid","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-184367","object_id":"column-184367","name":"iPOsID","name_without_path":"iPOsID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-184368","object_id":"column-184368","name":"iAmount_f","name_without_path":"iAmount_f","description":null,"is_pk":false,"is_identity":false,"data_type":"money","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-184369","object_id":"column-184369","name":"iAmount","name_without_path":"iAmount","description":null,"is_pk":false,"is_identity":false,"data_type":"money","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-184370","object_id":"column-184370","name":"cCode","name_without_path":"cCode","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"40","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-184371","object_id":"column-184371","name":"cItemCode","name_without_path":"cItemCode","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"60","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-184372","object_id":"column-184372","name":"dVouchDate","name_without_path":"dVouchDate","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]}],"relations":[],"triggers":[],"unique_keys":[],"dependencies":null,"imported_at":"2024-07-15 13:47"};