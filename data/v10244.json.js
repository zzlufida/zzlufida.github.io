window.repositoryObject = {"columns_custom_fields":[],"relations_custom_fields":[],"triggers_custom_fields":[],"object_id":"v10244","name":"CM_QEffectContractExecuteInfo","subtype":"VIEW","is_user_defined":false,"description":null,"script":"CREATE View CM_QEffectContractExecuteInfo      \r\nas      \r\n  \r\nSELECT C.GUID, C.strContractID,C.strContractName, N'B' AS Src,C.intPre, IsNull(C.intVaryID,0) as intVaryID,   \r\n IsNull(CA.intVaryID,0) As UnInureVary, IV.dblTotalCurrency, IV.dblTotalQuantity,  \r\n --执行金额  \r\n (Case   When (C.strContractKind like N'应%' and CM_SystemSet.cValue=N'1') then EI.dblExecCurrency  \r\n                When (C.strContractKind like N'应%' and CM_SystemSet.cValue=N'0') then CI.dblExecCurrency   \r\n  When C.strContractKind like N'采购类合同' then V2.decExecRateMoney  \r\n  When (C.strContractKind like  N'销售类合同' and CM_SystemSet.cValue = N'1' and C.bUseStage = 1) then EI.dblExecCurrency   \r\n  When (C.strContractKind like  N'销售类合同' and C.bUseStage = 0) then V3.decExecRateMoney    \r\n  When (C.strContractKind like  N'进口类合同' and C.bUseStage = 0) then V4.decExecRateMoney    \r\n  When (C.strContractKind like  N'出口类合同' and C.bUseStage = 0) then V5.decExecRateMoney    \r\n\r\n  End) As dblExecCurrency,  \r\n --执行数量  \r\n (Case   When (C.strContractKind like N'应%' and CM_SystemSet.cValue=N'1') then EI.decExecCount  \r\n  When (C.strContractKind like N'应%' and CM_SystemSet.cValue=N'0') then CI.dblExecQuantity  \r\n  When C.strContractKind like  N'采购类合同' then V2.decExecCount  \r\n  When (C.strContractKind like  N'销售类合同' and CM_SystemSet.cValue = N'1' and C.bUseStage = 1) then EI.decExecCount   \r\n  When (C.strContractKind like  N'销售类合同' and C.bUseStage = 0) then V3.decExecCount \r\n  When (C.strContractKind like  N'进口类合同' and C.bUseStage = 0) then V4.decExecCount \r\n  When (C.strContractKind like  N'出口类合同' and C.bUseStage = 0) then V5.decExecCount    \r\n  End) As dblExecQuantity,  \r\n (Case When C.strContractKind like N'应%' then CI2.decRateMoneyAPAR  \r\n  When C.strContractKind like  N'采购类合同' then V2.decRateMoneyAPAR  \r\n  When C.strContractKind like  N'销售类合同' then V3.decRateMoneyAPAR\r\n  When C.strContractKind like  N'进口类合同' then V4.decRateMoneyAPAR  \r\n  When C.strContractKind like  N'出口类合同' then V5.decRateMoneyAPAR End) As dblAPARCurrency  \r\nFROM CM_Contract_B C  \r\n inner join CM_SystemSet on CM_SystemSet.cName=N'bUseExecBill'  \r\n Left JOin CM_Contract_A CA On C.strContractID=CA.strContractID And IsNull(CA.intVaryID,0)<>0  \r\n Left JOIN   \r\n (  \r\n     select cContractID,sum(decCount) as decExecCount,sum(decRateMoney) as dblExecCurrency  \r\n            from CM_EffectExecuteData group by cContractID  \r\n  \r\n )EI On C.strContractID = EI.cContractID  \r\n left JOIN (  \r\n  select GUID,sum(isnull(dblSum,0)) AS dblTotalCurrency,sum(isnull(dblQuantity,0)) AS dblTotalQuantity  \r\n  from CM_Contract_Item_B where intEnd=1 and intFlag <> 1 group by GUID) IV ON IV.GUID=C.GUID  \r\n         left join  \r\n               (  \r\n   select distinct b.cContractID, sum(isnull(bs.decRateMoney,0)) as dblExecCurrency, sum(isnull(bs.decCount,0)) as dblExecQuantity  \r\n   from CM_Balance b left join CM_Balances bs on b.cBalanceID=bs.cBalanceID  \r\n                 where isnull (b.dtAuditeDate, N'') <> N''  \r\n   group by b.cContractID  \r\n  ) CI On C.strContractID=CI.cContractID And C.strContractKind like N'应%'  \r\n left join( select distinct b2.cContractID,sum(isnull(bd2.decMoney,0)) as decRateMoneyAPAR  \r\n   from CM_Balance b2  \r\n   left join CM_BalanceDetail bd2 on b2.cBalanceID=bd2.cBalanceID  \r\n   where isnull(bd2.cProcStyle,'') not like 'XJ%' or (bd2.cProcStyle like 'XJ%' and bd2.cCancelNo in (select strSpare3 from CM_Balance))  \r\n   group by b2.cContractID  \r\n  ) CI2 On C.strContractID=CI2.cContractID And C.strContractKind like N'应%'  \r\n  \r\n LEFT JOIN (Select cContractID,Sum(decCount) As decExecCount,  \r\n  Sum(decRateMoney) As decExecRateMoney,Sum(decRateMoneyAPAR) As decRateMoneyAPAR  \r\n from CM_ExecInterface Where cOrderType=N'采购订单' And cFlag=1 Group By cContractID) V2  \r\n On V2.cContractID=C.strContractID And C.strContractKind=N'采购类合同'  \r\n LEFT JOIN (Select cContractID,Sum(decCount) As decExecCount,  \r\n  Sum(decRateMoney) As decExecRateMoney,Sum(decRateMoneyAPAR) As decRateMoneyAPAR  \r\n from CM_ExecInterface Where cOrderType=N'销售订单' And cFlag=1 Group By cContractID) V3  \r\n On V3.cContractID=C.strContractID And C.strContractKind=N'销售类合同'  \r\n \r\n LEFT JOIN (Select cContractID,Sum(decCount) As decExecCount,  \r\n  Sum(decRateMoney) As decExecRateMoney,Sum(decRateMoneyAPAR) As decRateMoneyAPAR  \r\n from CM_ExecInterface Where cOrderType=N'进口订单' And cFlag=1 Group By cContractID) V4  \r\n On V4.cContractID=C.strContractID And C.strContractKind=N'进口类合同' \r\n \r\n LEFT JOIN (Select cContractID,Sum(decCount) As decExecCount,  \r\n  Sum(decRateMoney) As decExecRateMoney,Sum(decRateMoneyAPAR) As decRateMoneyAPAR  \r\n from CM_ExecInterface Where cOrderType=N'出口订单' And cFlag=1 Group By cContractID) V5  \r\n On V5.cContractID=C.strContractID And C.strContractKind=N'出口类合同' \r\n \r\n where isnull(C.strEndCasePerson,'')=''","summary":[{"field":"Documentation","value":{"_type":"link","name":"U8V16.5数据字典","id":"d6"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"CM_QEffectContractExecuteInfo"},{"field":"Type","value":"View"}],"columns":[{"id":"column-179266","object_id":"column-179266","name":"GUID","name_without_path":"GUID","description":null,"is_pk":false,"is_identity":false,"data_type":"uniqueidentifier","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-179267","object_id":"column-179267","name":"strContractID","name_without_path":"strContractID","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"64","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-179268","object_id":"column-179268","name":"strContractName","name_without_path":"strContractName","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"400","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-179269","object_id":"column-179269","name":"Src","name_without_path":"Src","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"1","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-179270","object_id":"column-179270","name":"intPre","name_without_path":"intPre","description":null,"is_pk":false,"is_identity":false,"data_type":"tinyint","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-179271","object_id":"column-179271","name":"intVaryID","name_without_path":"intVaryID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-179272","object_id":"column-179272","name":"UnInureVary","name_without_path":"UnInureVary","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-179273","object_id":"column-179273","name":"dblTotalCurrency","name_without_path":"dblTotalCurrency","description":null,"is_pk":false,"is_identity":false,"data_type":"float","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-179274","object_id":"column-179274","name":"dblTotalQuantity","name_without_path":"dblTotalQuantity","description":null,"is_pk":false,"is_identity":false,"data_type":"float","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-179275","object_id":"column-179275","name":"dblExecCurrency","name_without_path":"dblExecCurrency","description":null,"is_pk":false,"is_identity":false,"data_type":"float","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-179276","object_id":"column-179276","name":"dblExecQuantity","name_without_path":"dblExecQuantity","description":null,"is_pk":false,"is_identity":false,"data_type":"float","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-179277","object_id":"column-179277","name":"dblAPARCurrency","name_without_path":"dblAPARCurrency","description":null,"is_pk":false,"is_identity":false,"data_type":"float","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]}],"relations":[],"triggers":[],"unique_keys":[],"dependencies":null,"imported_at":"2024-07-15 13:47"};