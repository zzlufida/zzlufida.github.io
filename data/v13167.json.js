window.repositoryObject = {"columns_custom_fields":[],"relations_custom_fields":[],"triggers_custom_fields":[],"object_id":"v13167","name":"V_ExpenseItem","subtype":"VIEW","is_user_defined":false,"description":null,"script":"--\r\n--网报单据录入费用项目未自动带出关联的预算项目:由于费用项目参照数据中没有预算项目的值_ExpenseItem_AA 参照内部 使用的是 BG_V_CtrlItem 视图,需要使用BG_V_CtrlItemNew（这个有年度）这个视图\r\nCREATE VIEW [dbo].[V_ExpenseItem]        \r\nAS        \r\n/*    \r\n预算升级说明：   \r\n如果升级在此失败，请按照如下两点进行升级：   \r\n1、如果预算帐套和该帐套是同一帐套，请保持帐套号不变；如果预算帐套和该帐套不同，确保预算帐套的帐套号保持不变。   \r\n2、如果预算帐套和该帐套是同一帐套，直接升级；如果预算帐套和该帐套不同，先升级预算帐套，再进行该帐套升级。   \r\n*/      \r\nSELECT ExpenseItem.cExpCode,ExpenseItem.cExpName,ExpenseItem.cExpMemo,ExpenseItem.pubufts,ExpenseItem.cExpProfitCode,    \r\nExpenseItem.cExpCCode,ExpenseItem.iExpTaxRate,ExpenseItem.iExpProfitItem,ExpenseItem.CCode,ExpenseItem.Direction,        \r\nexpenseBudget.cItemCode AS BudgetItemCode,budgetItem.cItemName AS BudgetItemName,    \r\nExpenseItem.OperationTypeCode,ExpenseItem.OperationTypeName,ExpenseItem.IsSubsidy        \r\nFROM ExpenseItem     \r\njoin (select cExpCode ,cItemCode,iYear  from ExpenseItem_BudgetDetail group by cExpCode ,cItemCode,iYear) as expenseBudget    \r\n         on expenseBudget.cExpCode=ExpenseItem.cExpCode    \r\nleft join BG_V_CtrlItem as budgetItem    \r\n         on expenseBudget.cItemCode=budgetItem.cItemCode  and   expenseBudget.iYear=budgetItem.iYear   \r\nwhere (select count(cExpCode) from (select cExpCode ,cItemCode,iYear  from ExpenseItem_BudgetDetail group by cExpCode ,cItemCode,iYear) as ExpenseItem_BudgetDetail where ExpenseItem.cExpCode=ExpenseItem_BudgetDetail.cExpCode)=1  \r\nUNION    \r\nSELECT ExpenseItem.cExpCode,ExpenseItem.cExpName,ExpenseItem.cExpMemo,ExpenseItem.pubufts,ExpenseItem.cExpProfitCode,ExpenseItem.cExpCCode,    \r\nExpenseItem.iExpTaxRate,ExpenseItem.iExpProfitItem,ExpenseItem.CCode,ExpenseItem.Direction,        \r\ncase when isnull(expenseBudgets.cExpCode,N'')<>N'' then null else ExpenseItem.BudgetItemCode end as BudgetItemCode,    \r\ncase when isnull(expenseBudgets.cExpCode,N'')<>N'' then null else ExpenseItem.BudgetItemName end as BudgetItemName,        \r\nExpenseItem.OperationTypeCode,ExpenseItem.OperationTypeName,ExpenseItem.IsSubsidy        \r\nFROM ExpenseItem      \r\nleft join     \r\n(    \r\n         --预算项目在预算系统已经不存在了    \r\n         select distinct budgetDetail.cExpCode from  (select cExpCode ,cItemCode,iYear  from ExpenseItem_BudgetDetail group by cExpCode ,cItemCode,iYear) as budgetDetail    \r\n         inner join (select distinct cExpCode from  (select cExpCode ,cItemCode,iYear  from ExpenseItem_BudgetDetail group by cExpCode ,cItemCode,iYear) as ExpenseItem_BudgetDetail where cItemCode not in(select cItemCode from BG_V_CtrlItem)) as notBudget    \r\n                   on budgetDetail.cExpCode=notBudget.cExpCode    \r\n) as expenseBudgets    \r\non ExpenseItem.cExpCode=expenseBudgets.cExpCode\r\nwhere (select count(cExpCode) from  (select cExpCode ,cItemCode,iYear  from ExpenseItem_BudgetDetail group by cExpCode ,cItemCode,iYear) as ExpenseItem_BudgetDetail where ExpenseItem.cExpCode=ExpenseItem_BudgetDetail.cExpCode)<>1","summary":[{"field":"Documentation","value":{"_type":"link","name":"U8V16.5数据字典","id":"d6"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"V_ExpenseItem"},{"field":"Type","value":"View"}],"columns":[{"id":"column-354680","object_id":"column-354680","name":"cExpCode","name_without_path":"cExpCode","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-354681","object_id":"column-354681","name":"cExpName","name_without_path":"cExpName","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"255","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-354682","object_id":"column-354682","name":"cExpMemo","name_without_path":"cExpMemo","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"30","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-354683","object_id":"column-354683","name":"pubufts","name_without_path":"pubufts","description":null,"is_pk":false,"is_identity":false,"data_type":"timestamp","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-354684","object_id":"column-354684","name":"cExpProfitCode","name_without_path":"cExpProfitCode","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-354685","object_id":"column-354685","name":"cExpCCode","name_without_path":"cExpCCode","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-354686","object_id":"column-354686","name":"iExpTaxRate","name_without_path":"iExpTaxRate","description":null,"is_pk":false,"is_identity":false,"data_type":"float","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-354687","object_id":"column-354687","name":"iExpProfitItem","name_without_path":"iExpProfitItem","description":null,"is_pk":false,"is_identity":false,"data_type":"smallint","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-354688","object_id":"column-354688","name":"CCode","name_without_path":"CCode","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"40","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-354689","object_id":"column-354689","name":"Direction","name_without_path":"Direction","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-354690","object_id":"column-354690","name":"BudgetItemCode","name_without_path":"BudgetItemCode","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-354691","object_id":"column-354691","name":"BudgetItemName","name_without_path":"BudgetItemName","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"255","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-354692","object_id":"column-354692","name":"OperationTypeCode","name_without_path":"OperationTypeCode","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-354693","object_id":"column-354693","name":"OperationTypeName","name_without_path":"OperationTypeName","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"255","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-354694","object_id":"column-354694","name":"IsSubsidy","name_without_path":"IsSubsidy","description":null,"is_pk":false,"is_identity":false,"data_type":"bit","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]}],"relations":[],"triggers":[],"unique_keys":[],"dependencies":null,"imported_at":"2024-07-15 13:47"};