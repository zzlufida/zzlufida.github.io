window.repositoryObject = {"columns_custom_fields":[],"relations_custom_fields":[],"triggers_custom_fields":[],"object_id":"v10280","name":"CM_QPayDetail","subtype":"VIEW","is_user_defined":false,"description":null,"script":"Create View CM_QPayDetail\r\nAS\r\nselect dbo.UDF_GetResourceMessageByID('U8.CW.CM.BalanceDetail') as cVoucherType,\r\n'Balance' as cSource,\r\nNull As cVouchID,\r\nD.cBalanceID As cCoVouchID,\t\t\t\t--结算单号，销售发票号\r\nB.cContractID as strContractID,-- 合同号\r\nNull as ContractRowGuid,\t--合同标的RowGUID\r\nD.balancesguid,\r\nNull As ibvid,\t\t\t\t--销售发票子表ID\r\nNull As  iPOsID,\t\t--销售订单子表ID\r\nD.decMoney as iAmount_f,\r\nD.decRMB as iAmount,\r\nB.dtAuditeDate as dPayDate\r\nfrom CM_BalanceDetail D\r\nInner Join CM_Balances S On D.BalancesGUID=S.BalancesGUID\r\nInner Join CM_Balance B On S.GUID=B.GUID And S.cBalanceID=B.cBalanceID\r\nwhere IsNull(D.cBill,'')=N''\r\nUnion\r\nselect\r\nAp_VouchType.cTypeName as cVoucherType,\r\n(case when Ap_Detail.cCoVouchType=N'60' then N'Balance' else N'PU' end) as cSource,\r\nAp_Detail.cVouchID,\t\t--收付款单号\r\nAp_Detail.cCoVouchID,\t\t--核销的原始单据号，结算单号，或者采购发票号\r\n(case when Ap_Detail.cCoVouchType=N'60' then Ap_Detail.cContractID else zpurbilltail.ContractCode end) as strContractID,\t\t-- 合同号\r\n(case when Ap_Detail.cCoVouchType=N'60' Then CI.RowGUID else zpurbilltail.ContractRowGuid end) as ContractRowGuid,\t--合同标的RowGUID\r\nAp_Detail.balancesguid,\t\t\t\t--结算单子表GUID\r\nAp_detail.ibvid,\t\t\t\t--采购发票子表ID\r\nzpurbilltail.iPOsID as iPOsID,\t\t--采购订单子表ID\r\nAp_Detail.iDAmount_f as iAmount_f,\t\t--原币金额\r\nAp_Detail.iDAmount as iAmount,\t\t--本币金额\r\nAp_Detail.dRegDate as dPayDate\r\nfrom Ap_Detail\r\nLEFT JOIN Ap_VouchType ON Ap_Detail.cVouchType = Ap_VouchType.cTypeCode \r\nLeft Join Ap_CloseBill On Ap_Detail.cDwCode=Ap_CloseBill.cDwCode and Ap_Detail.cVouchType=Ap_CloseBill.cVouchType And Ap_Detail.cVouchID=Ap_CloseBill.cVouchID And Ap_Detail.cFlag=Ap_CloseBill.cFlag\r\nLeft Join zpurbilltail on Ap_Detail.ibvid=zpurbilltail.id\r\nLeft Join (select V.RowGUID,S.balancesguid from CM_QContractItemView V\r\n\tINNER JOIN CM_Balance B On V.strContractID=B.cContractID\r\n\tINNER JOIN CM_Balances S On B.cBalanceID=S.cBalanceID And V.strCode=S.cCode)\r\n\tCI On Ap_Detail.balancesguid =CI.balancesguid\r\n--where (cprocstyle=N'9P' or cprocstyle=N'XJ') and (iFlag<3 or iFlag=5) and Ap_Detail.cFlag=N'AP'\r\n--and Ap_Detail.cvouchtype like N'4%' and Ap_Detail.ccovouchtype IN ('01','02','03','04','05','06','60')\r\nwhere cprocstyle<>Ap_Detail.ccovouchtype and (iFlag<3 or iFlag=5) and Ap_Detail.cFlag=N'AP'\r\n and Ap_Detail.ccovouchtype IN ('01','02','03','04','05','06','60')\r\nUnion\r\nselect Ap_VouchType.cTypeName as cVoucherType,\r\n(case when Ar_Detail.cCoVouchType=N'60' then N'Balance' else N'SA' end) as cSource,\r\nAr_Detail.cVouchID,\r\nAr_Detail.cCoVouchID,\t\t\t\t--结算单号，销售发票号\r\n(case when Ar_Detail.cCoVouchType=N'60' then Ar_Detail.cContractID else SaleBillVouchs.cContractID end) as strContractID,-- 合同号\r\n(case when Ar_Detail.cCoVouchType=N'60' Then CI.RowGUID else SaleBillVouchs.cContractRowGuid end) as ContractRowGuid,\t--合同标的RowGUID\r\nAr_Detail.balancesguid,\r\nAr_Detail.ibvid,\t\t\t\t--销售发票子表ID\r\nSaleBillVouchs.iSOsID as iPOsID,\t\t--销售订单子表ID\r\nAr_Detail.iCAmount_f as iAmount_f,\r\nAr_Detail.iCAmount as iAmount,\r\nAr_Detail.dRegDate as dPayDate\r\nfrom Ar_Detail\r\nLEFT JOIN Ap_VouchType ON Ar_Detail.cVouchType = Ap_VouchType.cTypeCode \r\nLeft Join Ap_CloseBill On Ar_Detail.cDwCode=Ap_CloseBill.cDwCode and Ar_Detail.cVouchType=Ap_CloseBill.cVouchType And Ar_Detail.cVouchID=Ap_CloseBill.cVouchID And Ar_Detail.cFlag=Ap_CloseBill.cFlag\r\nLeft Join SaleBillVouchs On Ar_Detail.ibvid=SaleBillVouchs.AutoID\r\nLeft Join (select V.RowGUID,S.balancesguid from CM_QContractItemView V\r\n\tINNER JOIN CM_Balance B On V.strContractID=B.cContractID\r\n\tINNER JOIN CM_Balances S On B.cBalanceID=S.cBalanceID And V.strCode=S.cCode)\r\n\tCI On Ar_Detail.balancesguid =CI.balancesguid\r\n--where (cprocstyle=N'9P' or cprocstyle=N'XJ') and (iFlag<3 or iFlag=5) and Ar_Detail.cFlag=N'AR'\r\n--and Ar_Detail.cvouchtype like N'4%' and Ar_Detail.ccovouchtype IN ('26','27','28','29','60') 收付款单\r\nwhere cprocstyle<>Ar_Detail.ccovouchtype and (iFlag<3 or iFlag=5) and Ar_Detail.cFlag=N'AR'\r\n and Ar_Detail.ccovouchtype IN ('26','27','28','29','60')\r\n\r\nUnion\r\nselect Ap_VouchType.cTypeName as cVoucherType,\t\r\ndbo.UDF_GetResourceMessageByID('U8.CW.CM.PrePay') as cSource,--预付\r\nAp_Detail.cVouchID,\r\ndbo.UDF_GetResourceMessageByID('U8.CW.CM.PrePay') As cCoVouchID,\t\t\t\t--结算单号，销售发票号\r\nAp_Detail.cContractID as strContractID,\t\t-- 合同号\r\nNull As ContractRowGuid,\r\nNull as balancesguid,\r\nNull As ibvid,\t\t\r\nNull As iPOsID,\t\t\r\nsum(Ap_Detail.iDAmount_f) As  iAmount_f,\r\nsum(Ap_Detail.iDAmount) as iAmount,\t\t--本币\r\nMax(Ap_Detail.dRegDate) as dPayDate\r\nfrom Ap_Detail\r\nLEFT JOIN Ap_VouchType ON Ap_Detail.cVouchType = Ap_VouchType.cTypeCode \r\nLeft Join Ap_CloseBill On Ap_Detail.cDwCode=Ap_CloseBill.cDwCode and Ap_Detail.cVouchType=Ap_CloseBill.cVouchType And Ap_Detail.cVouchID=Ap_CloseBill.cVouchID And Ap_Detail.cFlag=Ap_CloseBill.cFlag\r\nwhere Ap_Detail.cFlag=N'AP' and Ap_Detail.cvouchtype like N'4%'and Ap_Detail.bPrePay=1\r\nAnd IsNull(Ap_Detail.cContractID,'')<>''\r\ngroup by Ap_Detail.cdwcode,Ap_VouchType.cTypeName,Ap_Detail.cvouchid,Ap_Detail.cContractID\r\nUnion\r\nselect Ap_VouchType.cTypeName as cVoucherType,\r\ndbo.UDF_GetResourceMessageByID('U8.CW.CM.PreReceive') as cSource,\t--预收\r\nAr_Detail.cVouchID,\r\ndbo.UDF_GetResourceMessageByID('U8.CW.CM.PreReceive') As cCoVouchID,\t\t\t\t--结算单号，销售发票号\r\nAr_Detail.cContractID as strContractID,\t\t-- 合同号\r\nNull As ContractRowGuid,\r\nNull as balancesguid,\r\nNull As ibvid,\t\t\r\nNull As iPOsID,\t\t\r\nsum(Ar_Detail.iCAmount_f) As  iAmount_f,\r\nsum(Ar_Detail.iCAmount) as iAmount,\t\t--本币\r\nMax(Ar_Detail.dRegDate) as dPreDate\r\nfrom Ar_Detail\r\nLEFT JOIN Ap_VouchType ON Ar_Detail.cVouchType = Ap_VouchType.cTypeCode \r\nLeft Join Ap_CloseBill On Ar_Detail.cDwCode=Ap_CloseBill.cDwCode and Ar_Detail.cVouchType=Ap_CloseBill.cVouchType And Ar_Detail.cVouchID=Ap_CloseBill.cVouchID And Ar_Detail.cFlag=Ap_CloseBill.cFlag\r\nwhere Ar_Detail.cFlag=N'AR' and Ar_Detail.cvouchtype like N'4%'and Ar_Detail.bPrePay=1\r\nAnd IsNull(Ar_Detail.cContractID,'')<>''\r\ngroup by Ar_Detail.cdwcode,Ap_VouchType.cTypeName,Ar_Detail.cvouchid,Ar_Detail.cContractID","summary":[{"field":"Documentation","value":{"_type":"link","name":"U8V16.5数据字典","id":"d6"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"CM_QPayDetail"},{"field":"Type","value":"View"}],"columns":[{"id":"column-181820","object_id":"column-181820","name":"cVoucherType","name_without_path":"cVoucherType","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"2048","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-181821","object_id":"column-181821","name":"cSource","name_without_path":"cSource","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"2048","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-181822","object_id":"column-181822","name":"cVouchID","name_without_path":"cVouchID","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"30","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-181823","object_id":"column-181823","name":"cCoVouchID","name_without_path":"cCoVouchID","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"2048","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-181824","object_id":"column-181824","name":"strContractID","name_without_path":"strContractID","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"128","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-181825","object_id":"column-181825","name":"ContractRowGuid","name_without_path":"ContractRowGuid","description":null,"is_pk":false,"is_identity":false,"data_type":"uniqueidentifier","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-181826","object_id":"column-181826","name":"balancesguid","name_without_path":"balancesguid","description":null,"is_pk":false,"is_identity":false,"data_type":"uniqueidentifier","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-181827","object_id":"column-181827","name":"ibvid","name_without_path":"ibvid","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-181828","object_id":"column-181828","name":"iPOsID","name_without_path":"iPOsID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-181829","object_id":"column-181829","name":"iAmount_f","name_without_path":"iAmount_f","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"30, 4","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-181830","object_id":"column-181830","name":"iAmount","name_without_path":"iAmount","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"19, 4","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-181831","object_id":"column-181831","name":"dPayDate","name_without_path":"dPayDate","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]}],"relations":[],"triggers":[],"unique_keys":[],"dependencies":null,"imported_at":"2024-07-15 13:47"};