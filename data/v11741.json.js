window.repositoryObject = {"columns_custom_fields":[],"relations_custom_fields":[],"triggers_custom_fields":[],"object_id":"v11741","name":"NE_V_ExpenseItem","subtype":"VIEW","is_user_defined":false,"description":null,"script":"CREATE VIEW [dbo].[NE_V_ExpenseItem]        \r\nAS        \r\n/*    \r\n预算升级说明：   \r\n如果升级在此失败，请按照如下两点进行升级：   \r\n1、如果预算帐套和该帐套是同一帐套，请保持帐套号不变；如果预算帐套和该帐套不同，确保预算帐套的帐套号保持不变。   \r\n2、如果预算帐套和该帐套是同一帐套，直接升级；如果预算帐套和该帐套不同，先升级预算帐套，再进行该帐套升级。   \r\n*/    \r\n     \r\nSELECT ExpenseItem.cExpCode,ExpenseItem.cExpName,ExpenseItem.cExpMemo,ExpenseItem.pubufts,ExpenseItem.cExpProfitCode,        \r\nExpenseItem.cExpCCode,ExpenseItem.iExpTaxRate,ExpenseItem.iExpProfitItem,convert(nvarchar(80),'') AS CCode,ExpenseItem.Direction,            \r\nbudgetItem.cItemCode AS BudgetItemCode,budgetItem.cItemName AS BudgetItemName,        \r\nExpenseItem.OperationTypeCode,ExpenseItem.OperationTypeName,ExpenseItem.IsSubsidy,expenseBudget.iYear as BudgetYear          \r\nFROM ExpenseItem         \r\n join ExpenseItem_BudgetDetail as expenseBudget        \r\n         on expenseBudget.cExpCode=ExpenseItem.cExpCode        \r\nleft join BG_V_CtrlItemNew as budgetItem        \r\n         on expenseBudget.cItemCode=budgetItem.cItemCode AND expenseBudget.iYear= budgetItem.iYear      \r\nwhere \r\nexists(select cExpCode,iYear,COUNT(*)  from ExpenseItem_BudgetDetail where ExpenseItem.cExpCode=ExpenseItem_BudgetDetail.cExpCode group by cExpCode,iYear having COUNT(*)=1)\r\nand ExpenseItem.cExpCode not in (select a.cExpCode from ( select cExpCode,iYear,COUNT(*) as cou  from ExpenseItem_BudgetDetail group by cExpCode,iYear having COUNT(*)>1) as a)\r\n--(select count(cExpCode) from (select cExpCode ,cItemCode  from ExpenseItem_BudgetDetail group by cExpCode ,cItemCode) ExpenseItem_BudgetDetail where ExpenseItem.cExpCode=ExpenseItem_BudgetDetail.cExpCode)=1      \r\n--and expenseBudget.iYear=2016  and expenseBudget.cExpCode ='010101'\r\nUNION  \r\n\r\nSELECT ExpenseItem.cExpCode,ExpenseItem.cExpName,ExpenseItem.cExpMemo,ExpenseItem.pubufts,ExpenseItem.cExpProfitCode,ExpenseItem.cExpCCode,    \r\nExpenseItem.iExpTaxRate,ExpenseItem.iExpProfitItem,convert(nvarchar(80),'') AS CCode,ExpenseItem.Direction,        \r\ncase when isnull(expenseBudgets.cExpCode,N'')<>N'' then null else ExpenseItem.BudgetItemCode end as BudgetItemCode,    \r\ncase when isnull(expenseBudgets.cExpCode,N'')<>N'' then null else ExpenseItem.BudgetItemName end as BudgetItemName,        \r\nExpenseItem.OperationTypeCode,ExpenseItem.OperationTypeName,ExpenseItem.IsSubsidy ,expenseBudgets.iYear  as BudgetYear       \r\nFROM ExpenseItem      \r\nleft join     \r\n(    \r\n         --预算项目在预算系统已经不存在了    \r\n         select distinct budgetDetail.cExpCode,budgetDetail.iYear from ExpenseItem_BudgetDetail as budgetDetail    \r\n         inner join (select distinct cExpCode from ExpenseItem_BudgetDetail where cItemCode not in(select cItemCode from BG_V_CtrlItemNew)) as notBudget    \r\n                   on budgetDetail.cExpCode=notBudget.cExpCode    \r\n) as expenseBudgets    \r\non ExpenseItem.cExpCode=expenseBudgets.cExpCode   \r\nwhere exists(select cExpCode,iYear,COUNT(*)  from ExpenseItem_BudgetDetail where ExpenseItem.cExpCode=ExpenseItem_BudgetDetail.cExpCode group by cExpCode,iYear having COUNT(*)<>1)\r\nor(select count(cExpCode) from ExpenseItem_BudgetDetail where ExpenseItem.cExpCode=ExpenseItem_BudgetDetail.cExpCode)=0","summary":[{"field":"Documentation","value":{"_type":"link","name":"U8V16.5数据字典","id":"d6"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"NE_V_ExpenseItem"},{"field":"Type","value":"View"}],"columns":[{"id":"column-250754","object_id":"column-250754","name":"cExpCode","name_without_path":"cExpCode","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-250755","object_id":"column-250755","name":"cExpName","name_without_path":"cExpName","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"255","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-250756","object_id":"column-250756","name":"cExpMemo","name_without_path":"cExpMemo","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"30","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-250757","object_id":"column-250757","name":"pubufts","name_without_path":"pubufts","description":null,"is_pk":false,"is_identity":false,"data_type":"timestamp","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-250758","object_id":"column-250758","name":"cExpProfitCode","name_without_path":"cExpProfitCode","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-250759","object_id":"column-250759","name":"cExpCCode","name_without_path":"cExpCCode","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-250760","object_id":"column-250760","name":"iExpTaxRate","name_without_path":"iExpTaxRate","description":null,"is_pk":false,"is_identity":false,"data_type":"float","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-250761","object_id":"column-250761","name":"iExpProfitItem","name_without_path":"iExpProfitItem","description":null,"is_pk":false,"is_identity":false,"data_type":"smallint","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-250762","object_id":"column-250762","name":"CCode","name_without_path":"CCode","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"80","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-250763","object_id":"column-250763","name":"Direction","name_without_path":"Direction","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-250764","object_id":"column-250764","name":"BudgetItemCode","name_without_path":"BudgetItemCode","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-250765","object_id":"column-250765","name":"BudgetItemName","name_without_path":"BudgetItemName","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"255","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-250766","object_id":"column-250766","name":"OperationTypeCode","name_without_path":"OperationTypeCode","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-250767","object_id":"column-250767","name":"OperationTypeName","name_without_path":"OperationTypeName","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"255","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-250768","object_id":"column-250768","name":"IsSubsidy","name_without_path":"IsSubsidy","description":null,"is_pk":false,"is_identity":false,"data_type":"bit","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-250769","object_id":"column-250769","name":"BudgetYear","name_without_path":"BudgetYear","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]}],"relations":[],"triggers":[],"unique_keys":[],"dependencies":null,"imported_at":"2024-07-15 13:47"};