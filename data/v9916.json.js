window.repositoryObject = {"columns_custom_fields":[],"relations_custom_fields":[],"triggers_custom_fields":[],"object_id":"v9916","name":"AP_V_CMBalanceApply","subtype":"VIEW","is_user_defined":false,"description":null,"script":"CREATE VIEW [dbo].[AP_V_CMBalanceApply] \r\nAS\r\nSELECT CMs.cBalanceID,CMs.BalancesGuid,CMs.ExecDetailGUID,CMRow.RowGUID as contractrowguid,CMs.decRateUnitPrice,\r\n  (case when App.cCoVouchType is null then Vendor.cVenCode else App.cDwCode end) as cDwCode,Vendor.cVenName AS cDwName,CM.BalanceGuid, \r\n  (Convert(nvarchar,CMs.cBalanceID)+'-'+(case when App.cCoVouchType is null then Vendor.cVenCode else App.cDwCode end)) as GuidHead,\r\n  (Convert(nvarchar,CMs.id)+'-'+Convert(nvarchar(64),CMs.BalancesGuid)+'-'+(case when App.cCoVouchType is null then Vendor.cVenCode else App.cDwCode end)) as GuidBody,  \r\n  decRateMoney, \r\n  --合同结算单特殊\r\n  (case when App.cCoVouchType is null then decRateMoney-isnull(decSum,0) else iRAmount_f end) as iRAmount2_f,    \r\n   --本单可申请金额应该包括核销过的金额(发票同理)\r\n  iBillAmt_f,iCmPreAmt_f,iExecAmt_f,isnull(iXJAmount_f,0) as iCMBPayAmt_f,\r\n  Y_iBillAmt_f,Y_iCmPreAmt_f,Y_iExecAmt_f,isnull(iXJAmount_f,0) as Y_iCMBPayAmt_f,\r\n  (ISNULL(iBillAmt_f,0)+isnull(iXJAmount_f,0)) as iTotalAmt_f,\r\n  (ISNULL((case when App.cCoVouchType is null then decRateMoney-isnull(decSum,0) else iRAmount_f end),0)-ISNULL(iBillAmt_f,0)) as iApplySum_f,  \r\n  decRMB,(case when App.cCoVouchType is null then decRMB-isnull(decSumRMB,0) else iRAmount end) as iRAmount2,\r\n  iBillAmt,iCmPreAmt,iExecAmt,isnull(iXJAmount,0) as iCMBPayAmt,\r\n  Y_iBillAmt,Y_iCmPreAmt,Y_iExecAmt,isnull(iXJAmount,0) as Y_iCMBPayAmt,\r\n  (ISNULL(iBillAmt,0)+isnull(iXJAmount,0)) as iTotalAmt,\r\n  (ISNULL((case when App.cCoVouchType is null then decRMB-isnull(decSumRMB,0) else iRAmount end),0)-ISNULL(iBillAmt,0)) as iApplySum \r\n  FROM CM_Balances CMs  \r\n  INNER JOIN CM_Balance CM ON CM.cBalanceID=CMs.cBalanceID  \r\n  INNER JOIN V_CM_Contract C ON CM.GUID = C.GUID \r\n  LEFT JOIN Vendor ON C.strBisectionUnit = Vendor.cVenCode   \r\n  left JOIN AP_V_CancelDetail App ON CMs.BalancesGuid=App.BalancesGuid and cCoVouchType like '60%'   \r\n  --合同结算单已申请金额  \r\n  LEFT JOIN (  \r\n    SELECT BalancesGuid,cDwCode,sum(iSrcApplyAmt_f) as Y_iBillAmt_f,sum(iSrcApplyAmt) as Y_iBillAmt,sum(iBillAmt_f) as iBillAmt_f,sum(iBillAmt) as iBillAmt   \r\n    FROM AP_V_ApplyPayCal WHERE cSource=N'合同结算单' GROUP BY BalancesGuid,cDwCode  \r\n  ) AS AppPU ON isnull(App.BalancesGuid,CMs.BalancesGuid)=AppPU.BalancesGuid and isnull(App.cDwCode,C.strBisectionUnit)=AppPU.cDwCode        \r\n  --合同执行单已申请金额  \r\n  LEFT JOIN (  \r\n    SELECT BalancesGuid,sum(iSrcApplyAmt_f) as Y_iExecAmt_f,sum(iSrcApplyAmt) as Y_iExecAmt,sum(iBillAmt_f) as iExecAmt_f,sum(iBillAmt) as iExecAmt   \r\n    FROM AP_V_ApplyPayCal WHERE cSource=N'合同执行单' GROUP BY BalancesGuid\r\n  ) AS CMExec ON CMExec.BalancesGuid = CMs.ExecDetailGUID\r\n  LEFT JOIN VWCONTRACTPOSA CMRow ON CMRow.strContractID=CM.cContractID and CMRow.strCode=CMs.cCode  \r\n  --合同预付款  \r\n  LEFT JOIN (  \r\n    SELECT BalancesGuid,sum(iSrcApplyAmt_f) as Y_iCmPreAmt_f,sum(iSrcApplyAmt) as Y_iCmPreAmt,sum(iBillAmt_f) as iCmPreAmt_f,sum(iBillAmt) as iCmPreAmt   \r\n    FROM AP_V_ApplyPayCal WHERE cSource=N'合同' GROUP BY BalancesGuid  \r\n  ) AS AppCM ON CMRow.RowGUID=AppCM.BalancesGuid  \r\n  --结算单现结\r\n  left join (\r\n\tSELECT BalancesGuid ,sum(iAmount) as iXJAmount,sum(iAmount_f) as iXJAmount_f FROM Ap_XjDetail with(nolock) where cCoVouchType like '60'\r\n\tgroup by BalancesGuid) Xj ON CMs.BalancesGuid =Xj.BalancesGuid","summary":[{"field":"Documentation","value":{"_type":"link","name":"U8V16.5数据字典","id":"d6"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"AP_V_CMBalanceApply"},{"field":"Type","value":"View"}],"columns":[{"id":"column-164046","object_id":"column-164046","name":"cBalanceID","name_without_path":"cBalanceID","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"30","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164047","object_id":"column-164047","name":"BalancesGuid","name_without_path":"BalancesGuid","description":null,"is_pk":false,"is_identity":false,"data_type":"uniqueidentifier","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164048","object_id":"column-164048","name":"ExecDetailGUID","name_without_path":"ExecDetailGUID","description":null,"is_pk":false,"is_identity":false,"data_type":"uniqueidentifier","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164049","object_id":"column-164049","name":"contractrowguid","name_without_path":"contractrowguid","description":null,"is_pk":false,"is_identity":false,"data_type":"uniqueidentifier","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164050","object_id":"column-164050","name":"decRateUnitPrice","name_without_path":"decRateUnitPrice","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"18, 6","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164051","object_id":"column-164051","name":"cDwCode","name_without_path":"cDwCode","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164052","object_id":"column-164052","name":"cDwName","name_without_path":"cDwName","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"98","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164053","object_id":"column-164053","name":"BalanceGuid","name_without_path":"BalanceGuid","description":null,"is_pk":false,"is_identity":false,"data_type":"uniqueidentifier","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164054","object_id":"column-164054","name":"GuidHead","name_without_path":"GuidHead","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"51","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164055","object_id":"column-164055","name":"GuidBody","name_without_path":"GuidBody","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"116","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164056","object_id":"column-164056","name":"decRateMoney","name_without_path":"decRateMoney","description":null,"is_pk":false,"is_identity":false,"data_type":"numeric","data_length":"30, 4","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164057","object_id":"column-164057","name":"iRAmount2_f","name_without_path":"iRAmount2_f","description":null,"is_pk":false,"is_identity":false,"data_type":"numeric","data_length":"31, 4","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164058","object_id":"column-164058","name":"iBillAmt_f","name_without_path":"iBillAmt_f","description":null,"is_pk":false,"is_identity":false,"data_type":"money","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164059","object_id":"column-164059","name":"iCmPreAmt_f","name_without_path":"iCmPreAmt_f","description":null,"is_pk":false,"is_identity":false,"data_type":"money","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164060","object_id":"column-164060","name":"iExecAmt_f","name_without_path":"iExecAmt_f","description":null,"is_pk":false,"is_identity":false,"data_type":"money","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164061","object_id":"column-164061","name":"iCMBPayAmt_f","name_without_path":"iCMBPayAmt_f","description":null,"is_pk":false,"is_identity":false,"data_type":"money","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164062","object_id":"column-164062","name":"Y_iBillAmt_f","name_without_path":"Y_iBillAmt_f","description":null,"is_pk":false,"is_identity":false,"data_type":"money","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164063","object_id":"column-164063","name":"Y_iCmPreAmt_f","name_without_path":"Y_iCmPreAmt_f","description":null,"is_pk":false,"is_identity":false,"data_type":"money","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164064","object_id":"column-164064","name":"Y_iExecAmt_f","name_without_path":"Y_iExecAmt_f","description":null,"is_pk":false,"is_identity":false,"data_type":"money","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164065","object_id":"column-164065","name":"Y_iCMBPayAmt_f","name_without_path":"Y_iCMBPayAmt_f","description":null,"is_pk":false,"is_identity":false,"data_type":"money","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164066","object_id":"column-164066","name":"iTotalAmt_f","name_without_path":"iTotalAmt_f","description":null,"is_pk":false,"is_identity":false,"data_type":"money","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164067","object_id":"column-164067","name":"iApplySum_f","name_without_path":"iApplySum_f","description":null,"is_pk":false,"is_identity":false,"data_type":"numeric","data_length":"32, 4","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164068","object_id":"column-164068","name":"decRMB","name_without_path":"decRMB","description":null,"is_pk":false,"is_identity":false,"data_type":"numeric","data_length":"30, 4","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164069","object_id":"column-164069","name":"iRAmount2","name_without_path":"iRAmount2","description":null,"is_pk":false,"is_identity":false,"data_type":"numeric","data_length":"31, 4","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164070","object_id":"column-164070","name":"iBillAmt","name_without_path":"iBillAmt","description":null,"is_pk":false,"is_identity":false,"data_type":"money","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164071","object_id":"column-164071","name":"iCmPreAmt","name_without_path":"iCmPreAmt","description":null,"is_pk":false,"is_identity":false,"data_type":"money","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164072","object_id":"column-164072","name":"iExecAmt","name_without_path":"iExecAmt","description":null,"is_pk":false,"is_identity":false,"data_type":"money","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164073","object_id":"column-164073","name":"iCMBPayAmt","name_without_path":"iCMBPayAmt","description":null,"is_pk":false,"is_identity":false,"data_type":"money","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164074","object_id":"column-164074","name":"Y_iBillAmt","name_without_path":"Y_iBillAmt","description":null,"is_pk":false,"is_identity":false,"data_type":"money","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164075","object_id":"column-164075","name":"Y_iCmPreAmt","name_without_path":"Y_iCmPreAmt","description":null,"is_pk":false,"is_identity":false,"data_type":"money","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164076","object_id":"column-164076","name":"Y_iExecAmt","name_without_path":"Y_iExecAmt","description":null,"is_pk":false,"is_identity":false,"data_type":"money","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164077","object_id":"column-164077","name":"Y_iCMBPayAmt","name_without_path":"Y_iCMBPayAmt","description":null,"is_pk":false,"is_identity":false,"data_type":"money","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164078","object_id":"column-164078","name":"iTotalAmt","name_without_path":"iTotalAmt","description":null,"is_pk":false,"is_identity":false,"data_type":"money","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-164079","object_id":"column-164079","name":"iApplySum","name_without_path":"iApplySum","description":null,"is_pk":false,"is_identity":false,"data_type":"numeric","data_length":"32, 4","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]}],"relations":[],"triggers":[],"unique_keys":[],"dependencies":null,"imported_at":"2024-07-15 13:47"};