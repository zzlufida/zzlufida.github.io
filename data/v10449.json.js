window.repositoryObject = {"columns_custom_fields":[],"relations_custom_fields":[],"triggers_custom_fields":[],"object_id":"v10449","name":"crm_v_getauthorityformerp","subtype":"VIEW","is_user_defined":false,"description":null,"script":"----------------------------------------------------2017.11 迭代\r\n---------------------------------------data 库执行\r\n--ufdata 权限\r\n---权限视图修改\r\n CREATE VIEW [dbo].[crm_v_getauthorityformerp]         \r\nAS         \r\n  SELECT ua_auth.cauth_id                     cauthid,   \r\n         'CRMOBJECT.' + t2.obj_name + ( CASE RIGHT(ua_auth.cauth_id, 2)   \r\n                                          WHEN '01' THEN '.REVIEW'   \r\n                                          --查看权限     \r\n                                          WHEN '02' THEN '.ADD'--新增权限     \r\n                                          WHEN '20' THEN '.SUBMIT' \r\n\t\t\t\t\t\t\t\t\t\t  WHEN '24' THEN '.MODIFY'  \r\n                                        --提交权限     \r\n                                        END ) cauthority   \r\n  FROM   ua_auth   \r\n         LEFT JOIN (SELECT cauth_id,   \r\n                           cauth_name   \r\n                    FROM   ua_auth   \r\n                    WHERE  igrade = 1   \r\n                           AND cauth_name IN (SELECT dd.label   \r\n                                              FROM   dd_object do   \r\n                                                     LEFT JOIN dd_dict_str dd   \r\n                                                            ON do.obj_name =   \r\n                                                               dd.dict_name   \r\n                                              WHERE  dd.lang_id = 2   \r\n                                                     AND do.obj_type > 2000   \r\n                                                     AND Len(ma_apps) > 0)) t1   \r\n                ON ua_auth.cauth_id LIKE t1.cauth_id + '%'  \r\n                   \r\n         LEFT JOIN (SELECT dd.label,   \r\n                           do.obj_name   \r\n                    FROM   dd_object do   \r\n                           LEFT JOIN dd_dict_str dd   \r\n                                  ON do.obj_name = dd.dict_name   \r\n                    WHERE  dd.lang_id = 2   \r\n                           AND do.obj_type > 2000   \r\n                           AND Len(ma_apps) > 0) t2   \r\n                ON t1.cauth_name = t2.label   \r\n  WHERE  RIGHT(ua_auth.cauth_id, 2) IN ( '01', '02', '20','24' )   \r\n         AND igrade = 3  AND t2.obj_name IS NOT NULL  \r\n  UNION ALL   \r\n  SELECT ua_auth.cauth_id,   \r\n         'CRMOBJECT.' + t2.obj_name + '.EDIT'   \r\n  FROM   ua_auth   \r\n         LEFT JOIN (SELECT cauth_id,   \r\n                           cauth_name   \r\n                    FROM   ua_auth   \r\n                    WHERE  igrade = 1   \r\n                           AND cauth_name IN (SELECT dd.label   \r\n                                              FROM   dd_object do   \r\n                                                     LEFT JOIN dd_dict_str dd   \r\n                                                            ON do.obj_name =   \r\n                                                               dd.dict_name   \r\n                                              WHERE  dd.lang_id = 2   \r\n                                                     AND do.obj_type > 2000   \r\n                                                     AND Len(ma_apps) > 0)) t1   \r\n                ON ua_auth.cauth_id LIKE t1.cauth_id + '%'   \r\n                left join   \r\n                (SELECT dd.label,   \r\n                           do.obj_name   \r\n                    FROM   dd_object do   \r\n                           LEFT JOIN dd_dict_str dd   \r\n                                  ON do.obj_name = dd.dict_name   \r\n                    WHERE  dd.lang_id = 2   \r\n                           AND do.obj_type > 2000   \r\n                           AND Len(ma_apps) > 0) t2   \r\n                ON t1.cauth_name = t2.label   \r\n  WHERE  RIGHT(ua_auth.cauth_id, 2) IN ( '02' )   \r\n         AND igrade = 3  AND t2.obj_name IS NOT NULL  \r\n  UNION ALL   \r\n  SELECT ua_auth.cauth_id,   \r\n         'CRMOBJECT.' + t2.obj_name + '.DELETE'   \r\n  FROM   ua_auth   \r\n         LEFT JOIN (SELECT cauth_id,   \r\n                           cauth_name   \r\n                    FROM   ua_auth   \r\n                    WHERE  igrade = 1   \r\n                           AND cauth_name IN (SELECT dd.label   \r\n                                              FROM   dd_object do   \r\n                                                     LEFT JOIN dd_dict_str dd   \r\n  ON do.obj_name =   \r\n                                                               dd.dict_name   \r\n                                              WHERE  dd.lang_id = 2   \r\n                                                     AND do.obj_type > 2000   \r\n                                                     AND Len(ma_apps) > 0)) t1   \r\n                ON ua_auth.cauth_id LIKE t1.cauth_id + '%'   \r\n                left join   \r\n                (SELECT dd.label,   \r\n                           do.obj_name   \r\n                    FROM   dd_object do   \r\n                           LEFT JOIN dd_dict_str dd   \r\n                                  ON do.obj_name = dd.dict_name   \r\n                    WHERE  dd.lang_id = 2   \r\n                           AND do.obj_type > 2000   \r\n                           AND Len(ma_apps) > 0) t2   \r\n                ON t1.cauth_name = t2.label   \r\n  WHERE  RIGHT(ua_auth.cauth_id, 2) IN ( '02' )   \r\n         AND igrade = 3  AND t2.obj_name IS NOT NULL  \r\n  union all\r\n  select cAuth_Id as cauthid,  'CRMOBJECT.'+case t2.obj_name when 'Service' then 'ServiceRequest' else t2.obj_name end +'.'+case t1.oper_type when 'Query' then 'REVIEW' when 'Del' then 'DELETE' else upper(t1.oper_type) end as cauthority from tc_operation t1 left join dd_object t2 on t1.obj_type=t2.obj_type where (t1.obj_type in (3,4,8,16,54,56,251,550,1510,231,709,50) or t1.obj_type>2000) and oper_type in ('Query','ADD','SUBMIT','Modify','Uncommit','Edit','Del','Remove','Approve')","summary":[{"field":"Documentation","value":{"_type":"link","name":"U8V16.5数据字典","id":"d6"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"crm_v_getauthorityformerp"},{"field":"Type","value":"View"}],"columns":[{"id":"column-189469","object_id":"column-189469","name":"cauthid","name_without_path":"cauthid","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"200","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]},{"id":"column-189470","object_id":"column-189470","name":"cauthority","name_without_path":"cauthority","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"139","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[]}],"relations":[],"triggers":[],"unique_keys":[],"dependencies":null,"imported_at":"2024-07-15 13:47"};